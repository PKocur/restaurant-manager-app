{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../service/customer-service-manager.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nfunction OrderComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"div\", 21)(2, \"span\", 22);\n    i0.ɵɵtext(3, \"Order of \");\n    i0.ɵɵelementStart(4, \"b\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(6, \"button\", 23);\n    i0.ɵɵtext(7, \"+\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const order_r4 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(order_r4.recognitionId);\n  }\n}\nfunction OrderComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"div\", 24)(2, \"span\", 22);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 22);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_18_Template_button_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const meal_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.addMeal(meal_r6.key.id));\n    });\n    i0.ɵɵtext(7, \"+\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_18_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const meal_r6 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.removeMeal(meal_r6.key.id));\n    });\n    i0.ɵɵtext(9, \"-\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const meal_r6 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(meal_r6.key.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" - \", meal_r6.value, \"\");\n  }\n}\nfunction OrderComponent_p_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total value: \", ctx_r2.getTotalCost(), \"\");\n  }\n}\nfunction OrderComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"div\", 27);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_26_Template_div_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const meal_r10 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.addMeal(meal_r10.id));\n    });\n    i0.ɵɵelementStart(2, \"span\", 22);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const meal_r10 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(meal_r10.name);\n  }\n}\nexport class OrderComponent {\n  constructor(customerServiceManager, formBuilder) {\n    this.customerServiceManager = customerServiceManager;\n    this.formBuilder = formBuilder;\n    this.addedMeals = new Map();\n    this.addOrderForm = this.formBuilder.group({\n      name: '',\n      price: ''\n    });\n  }\n  ngOnInit() {\n    this.getOrders();\n    this.getMeals();\n    console.log(new window.bootstrap.Modal(document.getElementById('addOrderModal')));\n    this.addOrderModal = new window.bootstrap.Modal(document.getElementById('addOrderModal'));\n  }\n  getMeals() {\n    this.customerServiceManager.getMeals().subscribe(data => {\n      this.meals = data;\n    });\n  }\n  getOrders() {\n    this.customerServiceManager.getOrders().subscribe(data => {\n      this.orders = data;\n    });\n  }\n  onAddOrderFormSubmit() {\n    this.addOrderForm.reset();\n  }\n  openAddOrderModal() {\n    this.addOrderModal.show();\n  }\n  closeAddOrderModal() {\n    this.addedMeals.clear();\n    this.addOrderModal.hide();\n  }\n  addMeal(id) {\n    if (id) {\n      this.customerServiceManager.getMeal(id).subscribe(meal => {\n        const mealFromMap = Array.from(this.addedMeals.keys()).find(m => m.id === meal.id);\n        if (mealFromMap) {\n          const quantity = this.addedMeals.get(mealFromMap) || 0;\n          this.addedMeals.set(mealFromMap, quantity + 1);\n        } else {\n          this.addedMeals.set(meal, 1);\n        }\n      });\n    }\n  }\n  removeMeal(id) {\n    if (id) {\n      const mealFromMap = Array.from(this.addedMeals.keys()).find(m => m.id === id);\n      if (mealFromMap) {\n        const quantity = this.addedMeals.get(mealFromMap) || 0;\n        if (quantity > 1) {\n          this.addedMeals.set(mealFromMap, quantity - 1);\n        } else {\n          this.addedMeals.delete(mealFromMap);\n        }\n      }\n    }\n  }\n  getTotalCost() {\n    let totalCost = 0;\n    this.addedMeals.forEach((quantity, meal) => {\n      if (meal.price) {\n        totalCost += meal.price * quantity;\n      }\n    });\n    return totalCost.toFixed(2);\n  }\n}\nOrderComponent.ɵfac = function OrderComponent_Factory(t) {\n  return new (t || OrderComponent)(i0.ɵɵdirectiveInject(i1.CustomerServiceManager), i0.ɵɵdirectiveInject(i2.FormBuilder));\n};\nOrderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OrderComponent,\n  selectors: [[\"app-order\"]],\n  decls: 32,\n  vars: 8,\n  consts: [[1, \"row\"], [\"class\", \"mx-5 col-3 my-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"display-1\", \"mx-5\", \"col-3\", \"my-3\", \"alert\", \"alert-info\", 3, \"click\"], [\"id\", \"addOrderModal\", \"tabindex\", \"-1\", \"aria-labelledby\", \"addOrderModal\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\", \"modal-lg\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [3, \"noValidate\", \"formGroup\", \"ngSubmit\"], [1, \"modal-body\"], [1, \"my-2\", \"form-group\"], [\"for\", \"name\"], [\"id\", \"name\", \"type\", \"text\", \"placeholder\", \"Enter order name\", \"required\", \"\", \"minlength\", \"3\", \"maxlength\", \"50\", \"formControlName\", \"name\", 1, \"form-control\"], [\"class\", \"fs-4\", 4, \"ngIf\"], [1, \"bg-danger\", \"border-2\", \"border-top\", \"border-secondary\"], [1, \"fs-4\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [1, \"mx-5\", \"col-3\", \"my-3\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\", \"id\"], [1, \"fs-3\"], [1, \"m-1\", \"btn\", \"btn-info\"], [\"role\", \"alert\", 1, \"alert\", \"alert-secondary\", \"id\"], [1, \"m-1\", \"btn\", \"btn-success\", 3, \"click\"], [1, \"m-1\", \"btn\", \"btn-danger\", 3, \"click\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\", \"id\", 3, \"click\"]],\n  template: function OrderComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, OrderComponent_div_1_Template, 8, 1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function OrderComponent_Template_button_click_2_listener() {\n        return ctx.openAddOrderModal();\n      });\n      i0.ɵɵtext(3, \" + \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"div\", 4)(6, \"div\", 5)(7, \"div\", 6)(8, \"h5\", 7);\n      i0.ɵɵtext(9, \"Add order\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"button\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"form\", 9);\n      i0.ɵɵlistener(\"ngSubmit\", function OrderComponent_Template_form_ngSubmit_11_listener() {\n        return ctx.onAddOrderFormSubmit();\n      });\n      i0.ɵɵelementStart(12, \"div\", 10)(13, \"div\", 11)(14, \"label\", 12);\n      i0.ɵɵtext(15, \" Name \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(16, \"input\", 13);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"div\", 0);\n      i0.ɵɵtemplate(18, OrderComponent_div_18_Template, 10, 2, \"div\", 1);\n      i0.ɵɵpipe(19, \"keyvalue\");\n      i0.ɵɵelementStart(20, \"div\");\n      i0.ɵɵtemplate(21, OrderComponent_p_21_Template, 2, 1, \"p\", 14);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(22, \"div\", 0);\n      i0.ɵɵelement(23, \"hr\", 15);\n      i0.ɵɵelementStart(24, \"p\", 16);\n      i0.ɵɵtext(25, \"Menu:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(26, OrderComponent_div_26_Template, 4, 1, \"div\", 1);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(27, \"div\", 17)(28, \"button\", 18);\n      i0.ɵɵlistener(\"click\", function OrderComponent_Template_button_click_28_listener() {\n        return ctx.closeAddOrderModal();\n      });\n      i0.ɵɵtext(29, \" Close \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"button\", 19);\n      i0.ɵɵtext(31, \" Add \");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.orders);\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"noValidate\", false)(\"formGroup\", ctx.addOrderForm);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(19, 6, ctx.addedMeals));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.getTotalCost() != \"0.00\");\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.meals);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.RequiredValidator, i2.MinLengthValidator, i2.MaxLengthValidator, i2.FormGroupDirective, i2.FormControlName, i3.KeyValuePipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","OrderComponent","constructor","customerServiceManager","formBuilder","Map","group","name","price","ngOnInit","getOrders","getMeals","console","log","window","bootstrap","Modal","document","getElementById","addOrderModal","subscribe","data","meals","orders","onAddOrderFormSubmit","addOrderForm","reset","openAddOrderModal","show","closeAddOrderModal","addedMeals","clear","hide","addMeal","id","getMeal","meal","mealFromMap","Array","from","keys","find","m","quantity","get","set","removeMeal","delete","getTotalCost","totalCost","forEach","toFixed","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/pkocur/IdeaProjects/restaurant-manager-frontend/transaction-app/src/app/component/order/order.component.html","/home/pkocur/IdeaProjects/restaurant-manager-frontend/transaction-app/src/app/component/order/order.component.ts"],"sourcesContent":["<div class=\"row\">\n  <div class=\"mx-5 col-3 my-3\" *ngFor=\"let order of orders; let index=index\">\n    <div class=\"alert alert-primary id\" role=\"alert\">\n      <span class=\"fs-3\">Order of <b>{{order.recognitionId}}</b></span>\n    </div>\n    <button class=\"m-1 btn btn-info\">+</button>\n  </div>\n  <button class=\"display-1 mx-5 col-3 my-3 alert alert-info\" (click)=\"openAddOrderModal()\">\n    +\n  </button>\n</div>\n\n<!-- Add order modal-->\n\n<div\n  class=\"modal fade\"\n  id=\"addOrderModal\"\n  tabindex=\"-1\"\n  aria-labelledby=\"addOrderModal\"\n  aria-hidden=\"true\"\n>\n  <div class=\"modal-dialog modal-lg\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\">Add order</h5>\n        <button\n          type=\"button\"\n          class=\"btn-close\"\n          data-bs-dismiss=\"modal\"\n          aria-label=\"Close\"\n        ></button>\n      </div>\n      <form [noValidate]=\"false\" [formGroup]=\"addOrderForm\" (ngSubmit)=\"onAddOrderFormSubmit()\">\n        <div class=\"modal-body\">\n          <div class=\"my-2 form-group\">\n            <label for=\"name\">\n              Name\n            </label>\n            <input class=\"form-control\" id=\"name\" type=\"text\" placeholder=\"Enter order name\" required minlength=\"3\"\n                   maxlength=\"50\" formControlName=\"name\"/>\n          </div>\n\n          <div class=\"row\">\n            <div class=\"mx-5 col-3 my-3\" *ngFor=\"let meal of addedMeals | keyvalue\">\n              <div class=\"alert alert-secondary id\" role=\"alert\">\n                <span class=\"fs-3\">{{meal.key.name}}</span>\n                <span class=\"fs-3\"> - {{meal.value}}</span>\n              </div>\n              <button class=\"m-1 btn btn-success\" (click)=\"addMeal(meal.key.id)\">+</button>\n              <button class=\"m-1 btn btn-danger\" (click)=\"removeMeal(meal.key.id)\">-</button>\n            </div>\n            <div>\n              <p *ngIf=\"getTotalCost() != '0.00'\" class=\"fs-4\">Total value: {{getTotalCost()}}</p>\n            </div>\n          </div>\n          <div class=\"row\">\n            <hr class=\"bg-danger border-2 border-top border-secondary\">\n            <p class=\"fs-4\">Menu:</p>\n            <div class=\"mx-5 col-3 my-3\" *ngFor=\"let meal of meals\">\n              <div class=\"alert alert-primary id\" role=\"alert\" (click)=\"addMeal(meal.id)\">\n                <span class=\"fs-3\">{{meal.name}}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\" (click)=\"closeAddOrderModal()\">\n            Close\n          </button>\n          <button type=\"submit\" class=\"btn btn-primary\">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n","import {Component, OnInit} from '@angular/core';\nimport {FormBuilder} from '@angular/forms';\nimport {Order} from \"../../model/order\";\nimport {CustomerServiceManager} from \"../../service/customer-service-manager.service\";\nimport {Meal} from \"../../model/meal\";\n\ndeclare var window: any;\n\n@Component({\n  selector: 'app-order',\n  templateUrl: './order.component.html',\n  styleUrls: ['./order.component.css']\n})\nexport class OrderComponent implements OnInit {\n  orders!: Order[];\n  meals!: Meal[];\n  addedMeals: Map<Meal, number> = new Map<Meal, number>();\n  addOrderModal: any;\n\n  addOrderForm = this.formBuilder.group({\n    name: '',\n    price: ''\n  });\n\n\n  constructor(private customerServiceManager: CustomerServiceManager,\n              private formBuilder: FormBuilder) {\n  }\n\n  ngOnInit(): void {\n    this.getOrders();\n    this.getMeals();\n    console.log(new window.bootstrap.Modal(\n      document.getElementById('addOrderModal')\n    ))\n    this.addOrderModal = new window.bootstrap.Modal(\n      document.getElementById('addOrderModal')\n    );\n  }\n\n  getMeals() {\n    this.customerServiceManager.getMeals().subscribe(data => {\n      this.meals = data;\n    })\n  }\n\n  getOrders() {\n    this.customerServiceManager.getOrders().subscribe(data => {\n      this.orders = data;\n    })\n  }\n\n  onAddOrderFormSubmit(): void {\n    this.addOrderForm.reset();\n  }\n\n  openAddOrderModal() {\n    this.addOrderModal.show();\n  }\n\n  closeAddOrderModal() {\n    this.addedMeals.clear();\n    this.addOrderModal.hide();\n  }\n\n  addMeal(id: number | null | undefined) {\n    if (id) {\n      this.customerServiceManager.getMeal(id).subscribe(meal => {\n        const mealFromMap = Array.from(this.addedMeals.keys()).find(m => m.id === meal.id);\n        if (mealFromMap) {\n          const quantity = this.addedMeals.get(mealFromMap) || 0;\n          this.addedMeals.set(mealFromMap, quantity + 1);\n        } else {\n          this.addedMeals.set(meal, 1);\n        }\n      })\n    }\n  }\n\n  removeMeal(id: number | null | undefined) {\n    if (id) {\n      const mealFromMap = Array.from(this.addedMeals.keys()).find(m => m.id === id);\n      if (mealFromMap) {\n        const quantity = this.addedMeals.get(mealFromMap) || 0;\n        if (quantity > 1) {\n          this.addedMeals.set(mealFromMap, quantity - 1);\n        } else {\n          this.addedMeals.delete(mealFromMap);\n        }\n      }\n    }\n  }\n\n  getTotalCost(): string {\n    let totalCost: number = 0;\n    this.addedMeals.forEach((quantity, meal) => {\n      if (meal.price) {\n        totalCost += meal.price * quantity;\n      }\n    });\n    return totalCost.toFixed(2);\n  }\n}\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}
