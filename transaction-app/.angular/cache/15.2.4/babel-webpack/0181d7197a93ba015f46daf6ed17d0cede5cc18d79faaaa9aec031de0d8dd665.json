{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../service/customer-service-manager.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nfunction OrderComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"div\", 27);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_1_Template_div_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const order_r7 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.openOrderModal(order_r7.id));\n    });\n    i0.ɵɵelementStart(2, \"span\", 28);\n    i0.ɵɵtext(3, \" Order of \");\n    i0.ɵɵelementStart(4, \"b\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(6, \"button\", 29);\n    i0.ɵɵtext(7, \"+\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const order_r7 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(order_r7.recognitionId);\n  }\n}\nfunction OrderComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 31)(2, \"span\", 28)(3, \"b\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"span\", 28);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 28);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const meal_r11 = ctx.$implicit;\n    let tmp_2_0;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(meal_r11.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" - \", meal_r11.quantity, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ((tmp_2_0 = meal_r11.price) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0) * ((tmp_2_0 = meal_r11.quantity) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0), \" z\\u0142\");\n  }\n}\nfunction OrderComponent_p_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total value: \", ctx_r2.getTotalCost(), \" z\\u0142\");\n  }\n}\nfunction OrderComponent_p_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 11);\n    i0.ɵɵtext(1, \"The order:\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction OrderComponent_div_36_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 31)(2, \"span\", 28)(3, \"b\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"span\", 28);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 28);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 33)(10, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_36_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const meal_r12 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.addMeal(meal_r12.id));\n    });\n    i0.ɵɵtext(11, \"+\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_36_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const meal_r12 = restoredCtx.$implicit;\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.removeMeal(meal_r12.id));\n    });\n    i0.ɵɵtext(13, \"-\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const meal_r12 = ctx.$implicit;\n    let tmp_2_0;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(meal_r12.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" - \", meal_r12.quantity, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ((tmp_2_0 = meal_r12.price) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0) * ((tmp_2_0 = meal_r12.quantity) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0), \" z\\u0142\");\n  }\n}\nfunction OrderComponent_p_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total value: \", ctx_r5.getTotalCost(), \" z\\u0142\");\n  }\n}\nfunction OrderComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 36);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_43_Template_div_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const meal_r16 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.addMeal(meal_r16.id));\n    });\n    i0.ɵɵelementStart(2, \"span\", 28)(3, \"b\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 28);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const meal_r16 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(meal_r16.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", meal_r16.price, \" z\\u0142\");\n  }\n}\nexport class OrderComponent {\n  constructor(customerServiceManager, formBuilder) {\n    this.customerServiceManager = customerServiceManager;\n    this.formBuilder = formBuilder;\n    this.addedMeals = [];\n    this.addOrderForm = this.formBuilder.group({\n      recognitionId: ''\n    });\n  }\n  ngOnInit() {\n    this.getOrders();\n    this.getMeals();\n    this.addOrderModal = new window.bootstrap.Modal(document.getElementById('addOrderModal'));\n    this.orderModal = new window.bootstrap.Modal(document.getElementById('orderModal'));\n  }\n  getMeals() {\n    this.customerServiceManager.getMeals().subscribe(data => {\n      this.meals = data;\n    });\n  }\n  getOrders() {\n    this.customerServiceManager.getOrders().subscribe(data => {\n      this.orders = data;\n    });\n  }\n  openOrderModal(id) {\n    if (id) {\n      this.getOrderMeals(id);\n    }\n    this.orderModal.show();\n  }\n  onAddOrderFormSubmit() {\n    this.addOrder({\n      \"recognitionId\": this.addOrderForm.value.recognitionId,\n      \"meals\": this.addedMeals\n    });\n    this.addOrderForm.reset();\n  }\n  addOrder(order) {\n    this.customerServiceManager.addOrder(order).subscribe(data => {\n      if (data) {\n        this.getOrders();\n        this.closeAddOrderModal();\n      }\n    });\n  }\n  openAddOrderModal() {\n    this.addOrderModal.show();\n  }\n  closeAddOrderModal() {\n    this.clearAddOrderModal();\n    this.addOrderModal.hide();\n  }\n  clearAddOrderModal() {\n    this.addedMeals = [];\n  }\n  getOrderMeals(id) {\n    if (id) {\n      this.customerServiceManager.getOrder(id).subscribe(order => {\n        if (order.meals) {\n          this.orderedMeals = order.meals;\n        }\n      });\n    }\n    return [];\n  }\n  addMeal(id) {\n    if (id) {\n      this.customerServiceManager.getMeal(id).subscribe(meal => {\n        const mealFromList = this.addedMeals.find(m => m.id === meal.id);\n        if (mealFromList && mealFromList.quantity) {\n          const index = this.addedMeals.indexOf(mealFromList);\n          mealFromList.quantity++;\n          this.addedMeals[index] = mealFromList;\n        } else {\n          this.addedMeals.push({\n            ...meal,\n            quantity: 1\n          });\n        }\n      });\n    }\n  }\n  removeMeal(id) {\n    if (id) {\n      const mealFromList = this.addedMeals.find(m => m.id === id);\n      if (mealFromList && mealFromList.quantity) {\n        if (mealFromList.quantity > 1) {\n          mealFromList.quantity--;\n        } else {\n          const index = this.addedMeals.indexOf(mealFromList);\n          this.addedMeals.splice(index, 1);\n        }\n      }\n    }\n  }\n  getTotalCost() {\n    let totalCost = 0;\n    this.addedMeals.forEach(meal => {\n      if (meal.price && meal.quantity) {\n        totalCost += meal.price * meal.quantity;\n      }\n    });\n    return totalCost.toFixed(2);\n  }\n}\nOrderComponent.ɵfac = function OrderComponent_Factory(t) {\n  return new (t || OrderComponent)(i0.ɵɵdirectiveInject(i1.CustomerServiceManager), i0.ɵɵdirectiveInject(i2.FormBuilder));\n};\nOrderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OrderComponent,\n  selectors: [[\"app-order\"]],\n  decls: 51,\n  vars: 9,\n  consts: [[1, \"row\"], [\"class\", \"mx-5 col-3 my-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"display-1\", \"mx-5\", \"col-3\", \"my-3\", \"alert\", \"alert-info\", 3, \"click\"], [\"id\", \"orderModal\", \"tabindex\", \"-1\", \"aria-labelledby\", \"orderModal\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\", \"modal-lg\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\"], [1, \"row\", \"d-flex\", \"justify-content-center\", \"align-items-center\"], [1, \"m-3\", \"fs-2\", \"text-center\"], [\"class\", \"m-3 col-3 my-3\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"fs-4\", 4, \"ngIf\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-secondary\"], [\"id\", \"addOrderModal\", \"tabindex\", \"-1\", \"aria-labelledby\", \"addOrderModal\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [3, \"noValidate\", \"formGroup\", \"ngSubmit\"], [1, \"my-2\", \"form-group\"], [\"for\", \"recognitionId\", 1, \"my-1\", \"fs-5\"], [\"id\", \"recognitionId\", \"type\", \"text\", \"placeholder\", \"Enter order recognition id\", \"required\", \"\", \"minlength\", \"3\", \"maxlength\", \"50\", \"formControlName\", \"recognitionId\", 1, \"form-control\"], [\"class\", \"m-3 fs-2 text-center\", 4, \"ngIf\"], [1, \"bg-danger\", \"border-2\", \"border-top\", \"border-secondary\"], [1, \"fs-2\", \"text-center\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [1, \"mx-5\", \"col-3\", \"my-3\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\", \"id\", 2, \"cursor\", \"pointer\", 3, \"click\"], [1, \"fs-3\"], [1, \"m-1\", \"btn\", \"btn-info\"], [1, \"m-3\", \"col-3\", \"my-3\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\", \"id\", \"text-center\"], [1, \"fs-4\"], [1, \"d-flex\", \"justify-content-center\"], [\"type\", \"button\", 1, \"m-1\", \"btn\", \"btn-success\", 3, \"click\"], [\"type\", \"button\", 1, \"m-1\", \"btn\", \"btn-danger\", 3, \"click\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\", \"id\", \"text-center\", 2, \"cursor\", \"pointer\", 3, \"click\"]],\n  template: function OrderComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, OrderComponent_div_1_Template, 8, 1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function OrderComponent_Template_button_click_2_listener() {\n        return ctx.openAddOrderModal();\n      });\n      i0.ɵɵtext(3, \" + \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"div\", 4)(6, \"div\", 5)(7, \"div\", 6)(8, \"h5\", 7);\n      i0.ɵɵtext(9, \"Order details\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"button\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"div\", 9)(12, \"div\", 10)(13, \"p\", 11);\n      i0.ɵɵtext(14, \"The order:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(15, OrderComponent_div_15_Template, 9, 3, \"div\", 12);\n      i0.ɵɵelementStart(16, \"div\");\n      i0.ɵɵtemplate(17, OrderComponent_p_17_Template, 2, 1, \"p\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(18, \"div\", 14)(19, \"button\", 15);\n      i0.ɵɵtext(20, \" Close \");\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(21, \"div\", 16)(22, \"div\", 4)(23, \"div\", 5)(24, \"div\", 6)(25, \"h5\", 7);\n      i0.ɵɵtext(26, \"Add order\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(27, \"button\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"form\", 17);\n      i0.ɵɵlistener(\"ngSubmit\", function OrderComponent_Template_form_ngSubmit_28_listener() {\n        return ctx.onAddOrderFormSubmit();\n      });\n      i0.ɵɵelementStart(29, \"div\", 9)(30, \"div\", 18)(31, \"label\", 19);\n      i0.ɵɵtext(32, \" Recognition id for the order \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(33, \"input\", 20);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"div\", 10);\n      i0.ɵɵtemplate(35, OrderComponent_p_35_Template, 2, 0, \"p\", 21);\n      i0.ɵɵtemplate(36, OrderComponent_div_36_Template, 14, 3, \"div\", 12);\n      i0.ɵɵelementStart(37, \"div\");\n      i0.ɵɵtemplate(38, OrderComponent_p_38_Template, 2, 1, \"p\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(39, \"div\", 10);\n      i0.ɵɵelement(40, \"hr\", 22);\n      i0.ɵɵelementStart(41, \"p\", 23);\n      i0.ɵɵtext(42, \"Menu:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(43, OrderComponent_div_43_Template, 7, 2, \"div\", 12);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(44, \"div\", 14)(45, \"button\", 24);\n      i0.ɵɵlistener(\"click\", function OrderComponent_Template_button_click_45_listener() {\n        return ctx.clearAddOrderModal();\n      });\n      i0.ɵɵtext(46, \" Clear \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(47, \"button\", 15);\n      i0.ɵɵtext(48, \" Close \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(49, \"button\", 25);\n      i0.ɵɵtext(50, \" Add \");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.orders);\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngForOf\", ctx.orderedMeals);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.addedMeals.length > 0);\n      i0.ɵɵadvance(11);\n      i0.ɵɵproperty(\"noValidate\", false)(\"formGroup\", ctx.addOrderForm);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.addedMeals.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.addedMeals);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.addedMeals.length > 0);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.meals);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.RequiredValidator, i2.MinLengthValidator, i2.MaxLengthValidator, i2.FormGroupDirective, i2.FormControlName],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","OrderComponent","constructor","customerServiceManager","formBuilder","group","recognitionId","ngOnInit","getOrders","getMeals","addOrderModal","window","bootstrap","Modal","document","getElementById","orderModal","subscribe","data","meals","orders","openOrderModal","id","getOrderMeals","show","onAddOrderFormSubmit","addOrder","addOrderForm","value","addedMeals","reset","order","closeAddOrderModal","openAddOrderModal","clearAddOrderModal","hide","getOrder","orderedMeals","addMeal","getMeal","meal","mealFromList","find","m","quantity","index","indexOf","push","removeMeal","splice","getTotalCost","totalCost","forEach","price","toFixed","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/pkocur/IdeaProjects/restaurant-manager-frontend/transaction-app/src/app/component/order/order.component.html","/home/pkocur/IdeaProjects/restaurant-manager-frontend/transaction-app/src/app/component/order/order.component.ts"],"sourcesContent":["<div class=\"row\">\n  <div class=\"mx-5 col-3 my-3\" *ngFor=\"let order of orders; let index=index\">\n    <div class=\"alert alert-primary id\" role=\"alert\" style=\"cursor: pointer;\" (click)=\"openOrderModal(order.id)\">\n      <span class=\"fs-3\">\n        Order of <b>{{order.recognitionId}}</b>\n      </span>\n    </div>\n    <button class=\"m-1 btn btn-info\">+</button>\n  </div>\n  <button class=\"display-1 mx-5 col-3 my-3 alert alert-info\" (click)=\"openAddOrderModal()\">\n    +\n  </button>\n</div>\n\n<!-- Order modal -->\n\n<div\n  class=\"modal fade\"\n  id=\"orderModal\"\n  tabindex=\"-1\"\n  aria-labelledby=\"orderModal\"\n  aria-hidden=\"true\"\n>\n  <div class=\"modal-dialog modal-lg\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\">Order details</h5>\n        <button\n          type=\"button\"\n          class=\"btn-close\"\n          data-bs-dismiss=\"modal\"\n          aria-label=\"Close\"\n        ></button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row d-flex justify-content-center align-items-center\">\n          <p class=\"m-3 fs-2 text-center\">The order:</p>\n          <div class=\"m-3 col-3 my-3\" *ngFor=\"let meal of orderedMeals\">\n            <div class=\"alert alert-primary id text-center\" role=\"alert\">\n              <span class=\"fs-3\"><b>{{meal.name}}</b></span>\n              <span class=\"fs-3\"> - {{meal.quantity}}</span>\n              <div class=\"fs-3\">{{ (meal.price ?? 0) * (meal.quantity ?? 0) }} zł</div>\n            </div>\n          </div>\n          <div>\n            <p *ngIf=\"addedMeals.length > 0\" class=\"fs-4\">Total value: {{getTotalCost()}} zł</p>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n            Close\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<!-- Add order modal-->\n\n<div\n  class=\"modal fade\"\n  id=\"addOrderModal\"\n  tabindex=\"-1\"\n  aria-labelledby=\"addOrderModal\"\n  aria-hidden=\"true\"\n>\n  <div class=\"modal-dialog modal-lg\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\">Add order</h5>\n        <button\n          type=\"button\"\n          class=\"btn-close\"\n          data-bs-dismiss=\"modal\"\n          aria-label=\"Close\"\n        ></button>\n      </div>\n      <form [noValidate]=\"false\" [formGroup]=\"addOrderForm\" (ngSubmit)=\"onAddOrderFormSubmit()\">\n        <div class=\"modal-body\">\n          <div class=\"my-2 form-group\">\n            <label class=\"my-1 fs-5\" for=\"recognitionId\">\n              Recognition id for the order\n            </label>\n            <input class=\"form-control\" id=\"recognitionId\" type=\"text\" placeholder=\"Enter order recognition id\" required\n                   minlength=\"3\"\n                   maxlength=\"50\" formControlName=\"recognitionId\"/>\n          </div>\n\n          <div class=\"row d-flex justify-content-center align-items-center\">\n            <p *ngIf=\"addedMeals.length > 0\" class=\"m-3 fs-2 text-center\">The order:</p>\n            <div class=\"m-3 col-3 my-3\" *ngFor=\"let meal of addedMeals\">\n              <div class=\"alert alert-primary id text-center\" role=\"alert\">\n                <span class=\"fs-3\"><b>{{meal.name}}</b></span>\n                <span class=\"fs-3\"> - {{meal.quantity}}</span>\n                <div class=\"fs-3\">{{ (meal.price ?? 0) * (meal.quantity ?? 0) }} zł</div>\n              </div>\n              <div class=\"d-flex justify-content-center\">\n                <button class=\"m-1 btn btn-success\" type=\"button\" (click)=\"addMeal(meal.id)\">+</button>\n                <button class=\"m-1 btn btn-danger\" type=\"button\" (click)=\"removeMeal(meal.id)\">-</button>\n              </div>\n            </div>\n            <div>\n              <p *ngIf=\"addedMeals.length > 0\" class=\"fs-4\">Total value: {{getTotalCost()}} zł</p>\n            </div>\n          </div>\n          <div class=\"row d-flex justify-content-center align-items-center\">\n            <hr class=\"bg-danger border-2 border-top border-secondary\">\n            <p class=\"fs-2 text-center\">Menu:</p>\n            <div class=\"m-3 col-3 my-3\" *ngFor=\"let meal of meals\">\n              <div class=\"alert alert-primary id text-center\" role=\"alert\" style=\"cursor: pointer;\"\n                   (click)=\"addMeal(meal.id)\">\n                <span class=\"fs-3\"><b>{{meal.name}}</b></span>\n                <div class=\"fs-3\">{{meal.price}} zł</div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-danger\" (click)=\"clearAddOrderModal()\">\n            Clear\n          </button>\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n            Close\n          </button>\n          <button type=\"submit\" class=\"btn btn-primary\">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n","import {Component, OnInit} from '@angular/core';\nimport {FormBuilder} from '@angular/forms';\nimport {Order} from \"../../model/order\";\nimport {CustomerServiceManager} from \"../../service/customer-service-manager.service\";\nimport {Meal} from \"../../model/meal\";\nimport {OrderedMeal} from \"../../model/orderedMeal\";\n\ndeclare var window: any;\n\n@Component({\n  selector: 'app-order',\n  templateUrl: './order.component.html',\n  styleUrls: ['./order.component.css']\n})\nexport class OrderComponent implements OnInit {\n  orders!: Order[];\n  meals!: Meal[];\n  addedMeals: OrderedMeal[] = [];\n  addOrderModal: any;\n  orderModal: any;\n  orderedMeals!: OrderedMeal[];\n\n  addOrderForm = this.formBuilder.group({\n    recognitionId: ''\n  });\n\n  constructor(private customerServiceManager: CustomerServiceManager,\n              private formBuilder: FormBuilder) {\n  }\n\n  ngOnInit(): void {\n    this.getOrders();\n    this.getMeals();\n    this.addOrderModal = new window.bootstrap.Modal(\n      document.getElementById('addOrderModal')\n    );\n    this.orderModal = new window.bootstrap.Modal(\n      document.getElementById('orderModal')\n    );\n  }\n\n  getMeals() {\n    this.customerServiceManager.getMeals().subscribe(data => {\n      this.meals = data;\n    })\n  }\n\n  getOrders() {\n    this.customerServiceManager.getOrders().subscribe(data => {\n      this.orders = data;\n    })\n  }\n\n  openOrderModal(id: number | null | undefined) {\n    if (id) {\n      this.getOrderMeals(id);\n    }\n    this.orderModal.show();\n  }\n\n  onAddOrderFormSubmit(): void {\n    this.addOrder({\n      \"recognitionId\": this.addOrderForm.value.recognitionId,\n      \"meals\": this.addedMeals\n    });\n    this.addOrderForm.reset();\n  }\n\n  addOrder(order: Partial<Order>): void {\n    this.customerServiceManager.addOrder(order).subscribe(data => {\n      if (data) {\n        this.getOrders();\n        this.closeAddOrderModal();\n      }\n    });\n  }\n\n  openAddOrderModal() {\n    this.addOrderModal.show();\n  }\n\n  closeAddOrderModal() {\n    this.clearAddOrderModal();\n    this.addOrderModal.hide();\n  }\n\n  clearAddOrderModal() {\n    this.addedMeals = [];\n  }\n\n  getOrderMeals(id: number | null | undefined): Meal[] {\n    if (id) {\n      this.customerServiceManager.getOrder(id).subscribe(order => {\n        if (order.meals) {\n          this.orderedMeals = order.meals;\n        }\n      })\n    }\n    return [];\n  }\n\n  addMeal(id: number | null | undefined) {\n    if (id) {\n      this.customerServiceManager.getMeal(id).subscribe(meal => {\n        const mealFromList = this.addedMeals.find(m => m.id === meal.id);\n        if (mealFromList && mealFromList.quantity) {\n          const index = this.addedMeals.indexOf(mealFromList);\n          mealFromList.quantity++;\n          this.addedMeals[index] = mealFromList;\n        } else {\n          this.addedMeals.push({...meal, quantity: 1})\n        }\n      })\n    }\n  }\n\n  removeMeal(id: number | null | undefined) {\n    if (id) {\n      const mealFromList = this.addedMeals.find(m => m.id === id);\n      if (mealFromList && mealFromList.quantity) {\n        if (mealFromList.quantity > 1) {\n          mealFromList.quantity--;\n        } else {\n          const index = this.addedMeals.indexOf(mealFromList);\n          this.addedMeals.splice(index, 1);\n        }\n      }\n    }\n  }\n\n  getTotalCost(): string {\n    let totalCost: number = 0;\n    this.addedMeals.forEach(meal => {\n      if (meal.price && meal.quantity) {\n        totalCost += meal.price * meal.quantity;\n      }\n    });\n    return totalCost.toFixed(2);\n  }\n}\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}
