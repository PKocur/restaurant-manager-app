{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../service/customer-service-manager.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nfunction OrderComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"div\", 27);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_1_Template_div_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const order_r7 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.openOrderModal(order_r7.id));\n    });\n    i0.ɵɵelementStart(2, \"span\", 28);\n    i0.ɵɵtext(3, \" Order of \");\n    i0.ɵɵelementStart(4, \"b\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(6, \"button\", 29);\n    i0.ɵɵtext(7, \"+\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const order_r7 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(order_r7.recognitionId);\n  }\n}\nfunction OrderComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 31)(2, \"span\", 28)(3, \"b\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"span\", 28);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 28);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const meal_r11 = ctx.$implicit;\n    let tmp_2_0;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(meal_r11.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" - \", meal_r11.quantity, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ((tmp_2_0 = meal_r11.price) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0) * ((tmp_2_0 = meal_r11.quantity) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0), \" z\\u0142\");\n  }\n}\nfunction OrderComponent_p_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total value: \", ctx_r2.getTotalCost(), \" z\\u0142\");\n  }\n}\nfunction OrderComponent_p_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 11);\n    i0.ɵɵtext(1, \"The order:\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction OrderComponent_div_36_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 31)(2, \"span\", 28)(3, \"b\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"span\", 28);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 28);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 33)(10, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_36_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const meal_r12 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.addMeal(meal_r12.key.id));\n    });\n    i0.ɵɵtext(11, \"+\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_36_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const meal_r12 = restoredCtx.$implicit;\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.removeMeal(meal_r12.key.id));\n    });\n    i0.ɵɵtext(13, \"-\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const meal_r12 = ctx.$implicit;\n    let tmp_2_0;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(meal_r12.key.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" - \", meal_r12.value, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ((tmp_2_0 = meal_r12.key.price) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0) * ((tmp_2_0 = meal_r12.value) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0), \" z\\u0142\");\n  }\n}\nfunction OrderComponent_p_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total value: \", ctx_r5.getTotalCost(), \" z\\u0142\");\n  }\n}\nfunction OrderComponent_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 36);\n    i0.ɵɵlistener(\"click\", function OrderComponent_div_44_Template_div_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const meal_r16 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.addMeal(meal_r16.id));\n    });\n    i0.ɵɵelementStart(2, \"span\", 28)(3, \"b\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 28);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const meal_r16 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(meal_r16.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", meal_r16.price, \" z\\u0142\");\n  }\n}\nexport class OrderComponent {\n  constructor(customerServiceManager, formBuilder) {\n    this.customerServiceManager = customerServiceManager;\n    this.formBuilder = formBuilder;\n    this.addedMeals = new Map();\n    this.addOrderForm = this.formBuilder.group({\n      name: '',\n      price: ''\n    });\n  }\n  ngOnInit() {\n    this.getOrders();\n    this.getMeals();\n    this.addOrderModal = new window.bootstrap.Modal(document.getElementById('addOrderModal'));\n    this.orderModal = new window.bootstrap.Modal(document.getElementById('orderModal'));\n  }\n  getMeals() {\n    this.customerServiceManager.getMeals().subscribe(data => {\n      this.meals = data;\n    });\n  }\n  getOrders() {\n    this.customerServiceManager.getOrders().subscribe(data => {\n      this.orders = data;\n    });\n  }\n  openOrderModal(id) {\n    if (id) {\n      this.getOrderMeals(id);\n    }\n    this.orderModal.show();\n  }\n  onAddOrderFormSubmit() {\n    this.addMeal({\n      \"name\": this.addOrderForm.value.name,\n      \"price\": Number(this.addOrderForm.value.price)\n    });\n    this.addOrderForm.reset();\n  }\n  addOrder(order) {\n    this.customerServiceManager.addOrder(order).subscribe(data => {\n      if (data) {\n        this.getOrders();\n      }\n    });\n  }\n  openAddOrderModal() {\n    this.addOrderModal.show();\n  }\n  clearAddOrderModal() {\n    this.addedMeals.clear();\n  }\n  getOrderMeals(id) {\n    if (id) {\n      this.customerServiceManager.getOrder(id).subscribe(order => {\n        if (order.meals) {\n          this.orderedMeals = order.meals;\n        }\n      });\n    }\n    return [];\n  }\n  addMeal(id) {\n    if (id) {\n      this.customerServiceManager.getMeal(id).subscribe(meal => {\n        const mealFromMap = Array.from(this.addedMeals.keys()).find(m => m.id === meal.id);\n        if (mealFromMap) {\n          const quantity = this.addedMeals.get(mealFromMap) || 0;\n          this.addedMeals.set(mealFromMap, quantity + 1);\n        } else {\n          this.addedMeals.set(meal, 1);\n        }\n      });\n    }\n  }\n  removeMeal(id) {\n    if (id) {\n      const mealFromMap = Array.from(this.addedMeals.keys()).find(m => m.id === id);\n      if (mealFromMap) {\n        const quantity = this.addedMeals.get(mealFromMap) || 0;\n        if (quantity > 1) {\n          this.addedMeals.set(mealFromMap, quantity - 1);\n        } else {\n          this.addedMeals.delete(mealFromMap);\n        }\n      }\n    }\n  }\n  getTotalCost() {\n    let totalCost = 0;\n    this.addedMeals.forEach((quantity, meal) => {\n      if (meal.price) {\n        totalCost += meal.price * quantity;\n      }\n    });\n    return totalCost.toFixed(2);\n  }\n}\nOrderComponent.ɵfac = function OrderComponent_Factory(t) {\n  return new (t || OrderComponent)(i0.ɵɵdirectiveInject(i1.CustomerServiceManager), i0.ɵɵdirectiveInject(i2.FormBuilder));\n};\nOrderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OrderComponent,\n  selectors: [[\"app-order\"]],\n  decls: 52,\n  vars: 11,\n  consts: [[1, \"row\"], [\"class\", \"mx-5 col-3 my-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"display-1\", \"mx-5\", \"col-3\", \"my-3\", \"alert\", \"alert-info\", 3, \"click\"], [\"id\", \"orderModal\", \"tabindex\", \"-1\", \"aria-labelledby\", \"orderModal\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\", \"modal-lg\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\"], [1, \"row\", \"d-flex\", \"justify-content-center\", \"align-items-center\"], [1, \"m-3\", \"fs-2\", \"text-center\"], [\"class\", \"m-3 col-3 my-3\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"fs-4\", 4, \"ngIf\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-secondary\"], [\"id\", \"addOrderModal\", \"tabindex\", \"-1\", \"aria-labelledby\", \"addOrderModal\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [3, \"noValidate\", \"formGroup\", \"ngSubmit\"], [1, \"my-2\", \"form-group\"], [\"for\", \"recognitionId\", 1, \"my-1\", \"fs-5\"], [\"id\", \"recognitionId\", \"type\", \"text\", \"placeholder\", \"Enter order recognition id\", \"required\", \"\", \"minlength\", \"3\", \"maxlength\", \"50\", \"formControlName\", \"recognitionId\", 1, \"form-control\"], [\"class\", \"m-3 fs-2 text-center\", 4, \"ngIf\"], [1, \"bg-danger\", \"border-2\", \"border-top\", \"border-secondary\"], [1, \"fs-2\", \"text-center\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [1, \"mx-5\", \"col-3\", \"my-3\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\", \"id\", 2, \"cursor\", \"pointer\", 3, \"click\"], [1, \"fs-3\"], [1, \"m-1\", \"btn\", \"btn-info\"], [1, \"m-3\", \"col-3\", \"my-3\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\", \"id\", \"text-center\"], [1, \"fs-4\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"m-1\", \"btn\", \"btn-success\", 3, \"click\"], [1, \"m-1\", \"btn\", \"btn-danger\", 3, \"click\"], [\"role\", \"alert\", 1, \"alert\", \"alert-primary\", \"id\", \"text-center\", 2, \"cursor\", \"pointer\", 3, \"click\"]],\n  template: function OrderComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, OrderComponent_div_1_Template, 8, 1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function OrderComponent_Template_button_click_2_listener() {\n        return ctx.openAddOrderModal();\n      });\n      i0.ɵɵtext(3, \" + \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"div\", 4)(6, \"div\", 5)(7, \"div\", 6)(8, \"h5\", 7);\n      i0.ɵɵtext(9, \"Order details\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"button\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"div\", 9)(12, \"div\", 10)(13, \"p\", 11);\n      i0.ɵɵtext(14, \"The order:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(15, OrderComponent_div_15_Template, 9, 3, \"div\", 12);\n      i0.ɵɵelementStart(16, \"div\");\n      i0.ɵɵtemplate(17, OrderComponent_p_17_Template, 2, 1, \"p\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(18, \"div\", 14)(19, \"button\", 15);\n      i0.ɵɵtext(20, \" Close \");\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(21, \"div\", 16)(22, \"div\", 4)(23, \"div\", 5)(24, \"div\", 6)(25, \"h5\", 7);\n      i0.ɵɵtext(26, \"Add order\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(27, \"button\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"form\", 17);\n      i0.ɵɵlistener(\"ngSubmit\", function OrderComponent_Template_form_ngSubmit_28_listener() {\n        return ctx.onAddOrderFormSubmit();\n      });\n      i0.ɵɵelementStart(29, \"div\", 9)(30, \"div\", 18)(31, \"label\", 19);\n      i0.ɵɵtext(32, \" Recognition id for the order \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(33, \"input\", 20);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"div\", 10);\n      i0.ɵɵtemplate(35, OrderComponent_p_35_Template, 2, 0, \"p\", 21);\n      i0.ɵɵtemplate(36, OrderComponent_div_36_Template, 14, 3, \"div\", 12);\n      i0.ɵɵpipe(37, \"keyvalue\");\n      i0.ɵɵelementStart(38, \"div\");\n      i0.ɵɵtemplate(39, OrderComponent_p_39_Template, 2, 1, \"p\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(40, \"div\", 10);\n      i0.ɵɵelement(41, \"hr\", 22);\n      i0.ɵɵelementStart(42, \"p\", 23);\n      i0.ɵɵtext(43, \"Menu:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(44, OrderComponent_div_44_Template, 7, 2, \"div\", 12);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(45, \"div\", 14)(46, \"button\", 24);\n      i0.ɵɵlistener(\"click\", function OrderComponent_Template_button_click_46_listener() {\n        return ctx.clearAddOrderModal();\n      });\n      i0.ɵɵtext(47, \" Clear \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(48, \"button\", 15);\n      i0.ɵɵtext(49, \" Close \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(50, \"button\", 25);\n      i0.ɵɵtext(51, \" Add \");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.orders);\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngForOf\", ctx.orderedMeals);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.addedMeals.size > 0);\n      i0.ɵɵadvance(11);\n      i0.ɵɵproperty(\"noValidate\", false)(\"formGroup\", ctx.addOrderForm);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.addedMeals.size > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(37, 9, ctx.addedMeals));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.addedMeals.size > 0);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.meals);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.RequiredValidator, i2.MinLengthValidator, i2.MaxLengthValidator, i2.FormGroupDirective, i2.FormControlName, i3.KeyValuePipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","OrderComponent","constructor","customerServiceManager","formBuilder","Map","group","name","price","ngOnInit","getOrders","getMeals","addOrderModal","window","bootstrap","Modal","document","getElementById","orderModal","subscribe","data","meals","orders","openOrderModal","id","getOrderMeals","show","onAddOrderFormSubmit","addMeal","addOrderForm","value","Number","reset","addOrder","order","openAddOrderModal","clearAddOrderModal","addedMeals","clear","getOrder","orderedMeals","getMeal","meal","mealFromMap","Array","from","keys","find","m","quantity","get","set","removeMeal","delete","getTotalCost","totalCost","forEach","toFixed","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/pkocur/IdeaProjects/restaurant-manager-frontend/transaction-app/src/app/component/order/order.component.html","/home/pkocur/IdeaProjects/restaurant-manager-frontend/transaction-app/src/app/component/order/order.component.ts"],"sourcesContent":["<div class=\"row\">\n  <div class=\"mx-5 col-3 my-3\" *ngFor=\"let order of orders; let index=index\">\n    <div class=\"alert alert-primary id\" role=\"alert\" style=\"cursor: pointer;\" (click)=\"openOrderModal(order.id)\">\n      <span class=\"fs-3\">\n        Order of <b>{{order.recognitionId}}</b>\n      </span>\n    </div>\n    <button class=\"m-1 btn btn-info\">+</button>\n  </div>\n  <button class=\"display-1 mx-5 col-3 my-3 alert alert-info\" (click)=\"openAddOrderModal()\">\n    +\n  </button>\n</div>\n\n<!-- Order modal -->\n\n<div\n  class=\"modal fade\"\n  id=\"orderModal\"\n  tabindex=\"-1\"\n  aria-labelledby=\"orderModal\"\n  aria-hidden=\"true\"\n>\n  <div class=\"modal-dialog modal-lg\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\">Order details</h5>\n        <button\n          type=\"button\"\n          class=\"btn-close\"\n          data-bs-dismiss=\"modal\"\n          aria-label=\"Close\"\n        ></button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row d-flex justify-content-center align-items-center\">\n          <p class=\"m-3 fs-2 text-center\">The order:</p>\n          <div class=\"m-3 col-3 my-3\" *ngFor=\"let meal of orderedMeals\">\n            <div class=\"alert alert-primary id text-center\" role=\"alert\">\n              <span class=\"fs-3\"><b>{{meal.name}}</b></span>\n              <span class=\"fs-3\"> - {{meal.quantity}}</span>\n              <div class=\"fs-3\">{{ (meal.price ?? 0) * (meal.quantity ?? 0) }} zł</div>\n            </div>\n          </div>\n          <div>\n            <p *ngIf=\"addedMeals.size > 0\" class=\"fs-4\">Total value: {{getTotalCost()}} zł</p>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n            Close\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<!-- Add order modal-->\n\n<div\n  class=\"modal fade\"\n  id=\"addOrderModal\"\n  tabindex=\"-1\"\n  aria-labelledby=\"addOrderModal\"\n  aria-hidden=\"true\"\n>\n  <div class=\"modal-dialog modal-lg\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\">Add order</h5>\n        <button\n          type=\"button\"\n          class=\"btn-close\"\n          data-bs-dismiss=\"modal\"\n          aria-label=\"Close\"\n        ></button>\n      </div>\n      <form [noValidate]=\"false\" [formGroup]=\"addOrderForm\" (ngSubmit)=\"onAddOrderFormSubmit()\">\n        <div class=\"modal-body\">\n          <div class=\"my-2 form-group\">\n            <label class=\"my-1 fs-5\" for=\"recognitionId\">\n              Recognition id for the order\n            </label>\n            <input class=\"form-control\" id=\"recognitionId\" type=\"text\" placeholder=\"Enter order recognition id\" required\n                   minlength=\"3\"\n                   maxlength=\"50\" formControlName=\"recognitionId\"/>\n          </div>\n\n          <div class=\"row d-flex justify-content-center align-items-center\">\n            <p *ngIf=\"addedMeals.size > 0\" class=\"m-3 fs-2 text-center\">The order:</p>\n            <div class=\"m-3 col-3 my-3\" *ngFor=\"let meal of addedMeals | keyvalue\">\n              <div class=\"alert alert-primary id text-center\" role=\"alert\">\n                <span class=\"fs-3\"><b>{{meal.key.name}}</b></span>\n                <span class=\"fs-3\"> - {{meal.value}}</span>\n                <div class=\"fs-3\">{{ (meal.key.price ?? 0) * (meal.value ?? 0) }} zł</div>\n              </div>\n              <div class=\"d-flex justify-content-center\">\n                <button class=\"m-1 btn btn-success\" (click)=\"addMeal(meal.key.id)\">+</button>\n                <button class=\"m-1 btn btn-danger\" (click)=\"removeMeal(meal.key.id)\">-</button>\n              </div>\n            </div>\n            <div>\n              <p *ngIf=\"addedMeals.size > 0\" class=\"fs-4\">Total value: {{getTotalCost()}} zł</p>\n            </div>\n          </div>\n          <div class=\"row d-flex justify-content-center align-items-center\">\n            <hr class=\"bg-danger border-2 border-top border-secondary\">\n            <p class=\"fs-2 text-center\">Menu:</p>\n            <div class=\"m-3 col-3 my-3\" *ngFor=\"let meal of meals\">\n              <div class=\"alert alert-primary id text-center\" role=\"alert\" style=\"cursor: pointer;\"\n                   (click)=\"addMeal(meal.id)\">\n                <span class=\"fs-3\"><b>{{meal.name}}</b></span>\n                <div class=\"fs-3\">{{meal.price}} zł</div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-danger\" (click)=\"clearAddOrderModal()\">\n            Clear\n          </button>\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n            Close\n          </button>\n          <button type=\"submit\" class=\"btn btn-primary\">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n","import {Component, OnInit} from '@angular/core';\nimport {FormBuilder} from '@angular/forms';\nimport {Order} from \"../../model/order\";\nimport {CustomerServiceManager} from \"../../service/customer-service-manager.service\";\nimport {Meal} from \"../../model/meal\";\nimport {OrderedMeal} from \"../../model/orderedMeal\";\n\ndeclare var window: any;\n\n@Component({\n  selector: 'app-order',\n  templateUrl: './order.component.html',\n  styleUrls: ['./order.component.css']\n})\nexport class OrderComponent implements OnInit {\n  orders!: Order[];\n  meals!: Meal[];\n  addedMeals: Map<Meal, number> = new Map<Meal, number>();\n  addOrderModal: any;\n  orderModal: any;\n  orderedMeals!: OrderedMeal[];\n\n  addOrderForm = this.formBuilder.group({\n    name: '',\n    price: ''\n  });\n\n  constructor(private customerServiceManager: CustomerServiceManager,\n              private formBuilder: FormBuilder) {\n  }\n\n  ngOnInit(): void {\n    this.getOrders();\n    this.getMeals();\n    this.addOrderModal = new window.bootstrap.Modal(\n      document.getElementById('addOrderModal')\n    );\n    this.orderModal = new window.bootstrap.Modal(\n      document.getElementById('orderModal')\n    );\n  }\n\n  getMeals() {\n    this.customerServiceManager.getMeals().subscribe(data => {\n      this.meals = data;\n    })\n  }\n\n  getOrders() {\n    this.customerServiceManager.getOrders().subscribe(data => {\n      this.orders = data;\n    })\n  }\n\n  openOrderModal(id: number | null | undefined) {\n    if (id) {\n      this.getOrderMeals(id);\n    }\n    this.orderModal.show();\n  }\n\n  onAddOrderFormSubmit(): void {\n    this.addMeal({\n      \"name\": this.addOrderForm.value.name,\n      \"price\": Number(this.addOrderForm.value.price)\n    });\n    this.addOrderForm.reset();\n  }\n\n  addOrder(order: Partial<Order>): void {\n    this.customerServiceManager.addOrder(order).subscribe(data => {\n      if (data) {\n        this.getOrders();\n      }\n    });\n  }\n\n\n  openAddOrderModal() {\n    this.addOrderModal.show();\n  }\n\n  clearAddOrderModal() {\n    this.addedMeals.clear();\n  }\n\n  getOrderMeals(id: number | null | undefined): Meal[] {\n    if (id) {\n      this.customerServiceManager.getOrder(id).subscribe(order => {\n        if (order.meals) {\n          this.orderedMeals = order.meals;\n        }\n      })\n    }\n    return [];\n  }\n\n  addMeal(id: number | null | undefined) {\n    if (id) {\n      this.customerServiceManager.getMeal(id).subscribe(meal => {\n        const mealFromMap = Array.from(this.addedMeals.keys()).find(m => m.id === meal.id);\n        if (mealFromMap) {\n          const quantity = this.addedMeals.get(mealFromMap) || 0;\n          this.addedMeals.set(mealFromMap, quantity + 1);\n        } else {\n          this.addedMeals.set(meal, 1);\n        }\n      })\n    }\n  }\n\n  removeMeal(id: number | null | undefined) {\n    if (id) {\n      const mealFromMap = Array.from(this.addedMeals.keys()).find(m => m.id === id);\n      if (mealFromMap) {\n        const quantity = this.addedMeals.get(mealFromMap) || 0;\n        if (quantity > 1) {\n          this.addedMeals.set(mealFromMap, quantity - 1);\n        } else {\n          this.addedMeals.delete(mealFromMap);\n        }\n      }\n    }\n  }\n\n  getTotalCost(): string {\n    let totalCost: number = 0;\n    this.addedMeals.forEach((quantity, meal) => {\n      if (meal.price) {\n        totalCost += meal.price * quantity;\n      }\n    });\n    return totalCost.toFixed(2);\n  }\n}\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}
